!function(a){"use strict";a.module("mvd.contentfulProvider",[]).provider("contentful",function(){var b,c=!1,d=[].push,e=[].slice,f=["id","type","updatedAt","createdAt"],g=["limit","order","content_type"],h=function(){if(c){var a=e.call(arguments,0);b.debug.apply(b,a)}},i={accessToken:"",space:""},j={},k={},l=this;l.setAuth=function(b,c){return a.isObject(b)?a.extend(i,b):(i.accessToken=b,i.space=c),l},l.setClientOptions=function(a){j=a},l.setDebug=function(a){c=a},l.setQueryOptions=function(a){k=a};var m=function(b){b=a.extend({},k,b);var c={};for(var d in b)if(b.hasOwnProperty(d)){var e=b[d];f.indexOf(d)>=0?d="sys."+d:g.indexOf(d)<0&&(d="fields."+d),c[d]=e}return c},n=function(b){var c=b.sys,d=a.copy(b.fields);for(var e in d)if(d.hasOwnProperty(e)){var g=d[e];a.isObject(g)&&a.isDefined(g.sys)&&a.isDefined(g.fields)&&(d[e]=n(g))}for(var h=0,i=f.length;i>h;h++){var j=f[h];a.isUndefined(d[j])&&a.isDefined(c[j])&&(d[j]=c[j])}return d};l.normalizeItems=function(a){if(!a)return a;for(var b=[],c=0,d=a.length;d>c;c++){var e=a[c],f=n(e);b.push(f)}return b};var o=function(a){return this._client=a,this};return o.prototype={get:function(b,c,d){h("[get]",arguments);var e={};return a.isObject(b)?b.limit=1:b={id:b,limit:1},b=m(b),this._client.entries(b).then(function(b){h("[get] success",b),a.extend(e,l.normalizeItems(b)[0]),h("[get] normalized result",e),c&&c(e)},function(a){h("[get] error",a),d&&d(a)}),e},load:function(a,b,c){h("[load]",arguments),a=m(a);var e=[];return this._client.entries(a).then(function(a){h("[load] success",a),d.apply(e,l.normalizeItems(a)),h("[get] normalized result",e),b&&b(e)},function(a){h("[load] error",a),c&&c(a)}),e}},this.$get=["$log","$window",function(c,d){if(b=c,!d.contentful)return c.warn("Contentful API client not loaded, unable to initialize ContentfulProvider"),null;var e=a.extend({},i,j),f=d.contentful.createClient(e);return new o(f)}],this})}(angular);